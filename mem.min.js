!function(a){function b(){function a(a,b){return Array.prototype.slice.call(a,b)}var b={on:function(a,c,d,e){var f=b._forSubject(a),g=!f.callbacks.some(function(a){return a.eventName===c});f.callbacks.push({eventName:c,action:d,iterations:e&&(e.once&&1||e.iterations)||null,context:e&&e.context,args:e&&e.args}),g&&c!==b._new_event_tracked_eventName&&b.trigger(a,b._new_event_tracked_eventName,c)},off:function(a,c,d){b._subjects=b._subjects.filter(function(b){return a&&b.subject!==a?!0:(b.callbacks=b.callbacks.filter(function(a){return c&&a.eventName!==c?!0:d&&a.action!==d?!0:!1}),!!b.callbacks.length)})},trigger:function(c,d){var e=a(arguments,2),f=!1,g=b._forSubject(c),h=[];if(g.running&&~g.running.indexOf(d)){var i=new Error(b._msg_recusions_not_allowed+": "+d+" on "+c.toString());throw i.subject=c,i.eventName=d,i.args=e,i}return g.running=g.running||[],g.running.push(d),g.callbacks.forEach(function(a){if(a.eventName===d){f=!0,a.iterations&&(a.iterations-=1);var g=(a.args||[]).concat(e);try{h.push(a.action.apply(a.context||c,g))}catch(i){c!==b||d!==b._error_eventName?b.trigger(b,b._error_eventName,c,d,i,a.context,a.action,g):b._fatal(b._msg_error_listener_error,c,d,i,a.context,a.action,g)}}}),g.callbacks=g.callbacks.filter(function(a){return a.eventName!==d?!0:0!==a.iterations}),g.running=g.running.filter(function(a){return d!==a}),g.callbacks.length||(b._subjects=b._subjects.filter(function(a){return a.subject===c?!1:!0})),f||(c===b&&d===b._error_eventName?b._fatal(b._msg_error_uncaught,arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]):d!==b._orphan_eventName&&b.trigger(b,b._orphan_eventName,c,d,e)),h},_new_event_tracked_eventName:"event_tracked",_orphan_eventName:"orphan_event",_error_eventName:"error",_msg_error_uncaught:"mem error event uncaught",_msg_error_listener_error:"mem error event listener error",_msg_recusions_not_allowed:"mem event recursion not allowed",_subjects:[],_forSubject:function(a){var c;return b._subjects.some(function(b){return b.subject!==a?!1:(c=b,!0)}),c||(c={subject:a,callbacks:[]},b._subjects.push(c)),c},_fatal:function(a,b,c,d,e,f,g){var h=new Error(a+": "+d.message);h.subject=b,h.eventName=c,h.error=d,h.context=e,h.action=f,h.args=g,setTimeout(function(){throw h},0)}};return b}"object"==typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define("mem",[],b):a.mem=b()}(this);